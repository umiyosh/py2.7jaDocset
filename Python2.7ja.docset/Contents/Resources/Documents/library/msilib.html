<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>34.1. msilib — Microsoft インストーラーファイルの読み書き — Python 2.7ja1 documentation</title>
<link href="../_static/sphinxdoc.css" rel="stylesheet" type="text/css"/>
<link href="../_static/pygments.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.7ja1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
<script src="../_static/jquery.js" type="text/javascript"></script>
<script src="../_static/underscore.js" type="text/javascript"></script>
<script src="../_static/doctools.js" type="text/javascript"></script>
<script src="../_static/translations.js" type="text/javascript"></script>
<link href="../_static/opensearch.xml" rel="search" title="Python 2.7ja1 documentation 内を検索" type="application/opensearchdescription+xml"/>
<link href="../about.html" rel="author" title="このドキュメントについて"/>
<link href="../copyright.html" rel="copyright" title="著作権"/>
<link href="../index.html" rel="top" title="Python 2.7ja1 documentation"/>
<link href="windows.html" rel="up" title="34. MS Windows 固有のサービス"/>
<link href="msvcrt.html" rel="next" title="34.2. msvcrt – MS VC++実行時システムの有用なルーチン群"/>
<link href="windows.html" rel="prev" title="34. MS Windows 固有のサービス"/>
<link href="../_static/py.png" rel="shortcut icon" type="image/png"/>
<script src="../_static/copybutton.js" type="text/javascript"></script>
<script src="../_static/_jp.js" type="text/javascript"></script>
</head>
<body>
<div class="related">
<h3>ナビゲーション</h3>
<ul>
<li class="right" style="margin-right: 10px">
<a accesskey="I" href="../genindex.html" title="総合索引">索引</a></li>
<li class="right">
<a href="../py-modindex.html" title="Pythonモジュール索引">モジュール</a> |</li>
<li class="right">
<a accesskey="N" href="msvcrt.html" title="34.2. msvcrt – MS VC++実行時システムの有用なルーチン群">次へ</a> |</li>
<li class="right">
<a accesskey="P" href="windows.html" title="34. MS Windows 固有のサービス">前へ</a> |</li>
<li><img alt="" src="../_static/py.png" style="vertical-align: middle; margin-top: -1px"/></li>
<li><a href="../index.html">Python 2.7ja1 documentation</a> »</li>
<li><a href="index.html">Python 標準ライブラリ</a> »</li>
<li><a accesskey="U" href="windows.html">34. MS Windows 固有のサービス</a> »</li>
</ul>
</div>
<div class="sphinxsidebar">
<div class="sphinxsidebarwrapper">
<h3><a href="../contents.html">目次</a></h3>
<ul>
<li><a class="reference internal" href="#">34.1. <tt class="docutils literal"><span class="pre">msilib</span></tt> — Microsoft インストーラーファイルの読み書き</a><ul>
<li><a class="reference internal" href="#database-objects">34.1.1. データベースオブジェクト</a></li>
<li><a class="reference internal" href="#view-objects">34.1.2. ビューオブジェクト</a></li>
<li><a class="reference internal" href="#summary-objects">34.1.3. サマリー情報オブジェクト</a></li>
<li><a class="reference internal" href="#record-objects">34.1.4. レコードオブジェクト</a></li>
<li><a class="reference internal" href="#msi-errors">34.1.5. エラー</a></li>
<li><a class="reference internal" href="#cab">34.1.6. CAB オブジェクト</a></li>
<li><a class="reference internal" href="#msi-directory">34.1.7. ディレクトリオブジェクト</a></li>
<li><a class="reference internal" href="#features">34.1.8. フィーチャー</a></li>
<li><a class="reference internal" href="#gui">34.1.9. GUI クラス</a></li>
<li><a class="reference internal" href="#msi-tables">34.1.10. 事前に計算されたテーブル</a></li>
</ul>
</li>
</ul>
<h4>前のトピックへ</h4>
<p class="topless"><a href="windows.html" title="前の章へ">34. MS Windows 固有のサービス</a></p>
<h4>次のトピックへ</h4>
<p class="topless"><a href="msvcrt.html" title="次の章へ">34.2. <tt class="docutils literal docutils literal"><span class="pre">msvcrt</span></tt> – MS VC++実行時システムの有用なルーチン群</a></p>
<h3>このページ</h3>
<ul class="this-page-menu">
<li><a href="../_sources/library/msilib.txt" rel="nofollow">ソースコードを表示</a></li>
</ul>
<div id="searchbox" style="display: none">
<h3>クイック検索</h3>
<form action="../search.html" class="search" method="get">
<input name="q" type="text"/>
<input type="submit" value="検索"/>
<input name="check_keywords" type="hidden" value="yes"/>
<input name="area" type="hidden" value="default"/>
</form>
<p class="searchtip" style="font-size: 90%">
    モジュール、クラス、または関数名を入力してください
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
</div>
</div>
<div class="document">
<div class="documentwrapper">
<div class="bodywrapper">
<div class="body">
<div class="section" id="module-msilib">
<span id="msilib-microsoft"></span><h1><a name="//apple_ref/cpp/Module/msilib"></a>34.1. <a class="reference internal" href="#module-msilib" title="msilib: Creation of Microsoft Installer files, and CAB files. (Windows)"><tt class="xref py py-mod docutils literal"><span class="pre">msilib</span></tt></a> — Microsoft インストーラーファイルの読み書き<a class="headerlink" href="#module-msilib" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p class="versionadded" id="index-0">
<span class="versionmodified">バージョン 2.5 で追加.</span></p>
<p><a class="reference internal" href="#module-msilib" title="msilib: Creation of Microsoft Installer files, and CAB files. (Windows)"><tt class="xref py py-mod docutils literal"><span class="pre">msilib</span></tt></a> モジュールは Microdoft インストーラー(<tt class="docutils literal"><span class="pre">.msi</span></tt>)の作成を支援します。このファイルはしばしば埋め込まれた「キャビネット」ファイル (<tt class="docutils literal"><span class="pre">.cab</span></tt>) を含むので、CAB ファイル作成用の API
も暴露します。現在のところ <tt class="docutils literal"><span class="pre">.cab</span></tt> ファイルの読み出しはサポートしていませんが、 <tt class="docutils literal"><span class="pre">.msi</span></tt> データベースの読み出しサポートは可能です。</p>
<p>このパッケージの目的は <tt class="docutils literal"><span class="pre">.msi</span></tt> ファイルにある全てのテーブルへの完全なアクセスの提供なので、提供されているものは正直に言って低レベルな API
です。このパッケージの二つの主要な応用は <a class="reference internal" href="distutils.html#module-distutils" title="distutils: 現在インストールされている Python に追加するためのモジュール構築、および実際のインストールを支援する。"><tt class="xref py py-mod docutils literal"><span class="pre">distutils</span></tt></a> の <tt class="docutils literal"><span class="pre">bdist_msi</span></tt> コマンドと、Python
インストーラーパッケージそれ自体(と言いつつ現在は別バージョンの <tt class="docutils literal"><span class="pre">msilib</span></tt> を使っているのですが)です。</p>
<p>パッケージの内容は大きく四つのパートに分けられます。低レベル CAB ルーチン、低レベル MSI ルーチン、少し高レベルの MSI ルーチン、標準的なテーブル構造、の四つです。</p>
<dl class="function">
<dt id="msilib.FCICreate"><a name="//apple_ref/cpp/Function/msilib.FCICreate"></a>
<tt class="descclassname">msilib.</tt><tt class="descname">FCICreate</tt><big>(</big><em>cabname</em>, <em>files</em><big>)</big><a class="headerlink" href="#msilib.FCICreate" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>新しい CAB ファイルを <em>cabname</em> という名前で作ります。 <em>files</em> はタプルのリストで、それぞれのタプルがディスク上のファイル名と CAB
ファイルで付けられるファイル名とからなるものでなければなりません。</p>
<p>ファイルはリストに現れた順番で CAB ファイルに追加されます。全てのファイルは MSZIP 圧縮アルゴリズムを使って一つの CAB ファイルに追加されます。</p>
<p>MSI 作成の様々なステップに対する Python コールバックは現在暴露されていません。</p>
</dd></dl>
<dl class="function">
<dt id="msilib.UuidCreate"><a name="//apple_ref/cpp/Function/msilib.UuidCreate"></a>
<tt class="descclassname">msilib.</tt><tt class="descname">UuidCreate</tt><big>(</big><big>)</big><a class="headerlink" href="#msilib.UuidCreate" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>新しい一意識別子の文字列表現を返します。この関数は Windows API の関数 <tt class="xref c c-func docutils literal"><span class="pre">UuidCreate()</span></tt> と
<tt class="xref c c-func docutils literal"><span class="pre">UuidToString()</span></tt> をラップしたものです。</p>
</dd></dl>
<dl class="function">
<dt id="msilib.OpenDatabase"><a name="//apple_ref/cpp/Function/msilib.OpenDatabase"></a>
<tt class="descclassname">msilib.</tt><tt class="descname">OpenDatabase</tt><big>(</big><em>path</em>, <em>persist</em><big>)</big><a class="headerlink" href="#msilib.OpenDatabase" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>MsiOpenDatabase を呼び出して新しいデータベースオブジェクトを返します。 <em>path</em> は MSI ファイルのファイル名です。 <em>persist</em>
は五つの定数 <tt class="docutils literal"><span class="pre">MSIDBOPEN_CREATEDIRECT</span></tt>, <tt class="docutils literal"><span class="pre">MSIDBOPEN_CREATE</span></tt>, <tt class="docutils literal"><span class="pre">MSIDBOPEN_DIRECT</span></tt>,
<tt class="docutils literal"><span class="pre">MSIDBOPEN_READONLY</span></tt>, <tt class="docutils literal"><span class="pre">MSIDBOPEN_TRANSACT</span></tt> のどれか一つで、フラグ
<tt class="docutils literal"><span class="pre">MSIDBOPEN_PATCHFILE</span></tt> を含めても構いません。これらのフラグの意味は Microsoft のドキュメントを参照してください。フラグに依って既存のデータベースを開いたり新しいのを作ったりします。</p>
</dd></dl>
<dl class="function">
<dt id="msilib.CreateRecord"><a name="//apple_ref/cpp/Function/msilib.CreateRecord"></a>
<tt class="descclassname">msilib.</tt><tt class="descname">CreateRecord</tt><big>(</big><em>count</em><big>)</big><a class="headerlink" href="#msilib.CreateRecord" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><tt class="xref c c-func docutils literal"><span class="pre">MSICreateRecord()</span></tt> を呼び出して新しいレコードオブジェクトを返します。 <em>count</em> はレコードのフィールドの数です。</p>
</dd></dl>
<dl class="function">
<dt id="msilib.init_database"><a name="//apple_ref/cpp/Function/msilib.init_database"></a>
<tt class="descclassname">msilib.</tt><tt class="descname">init_database</tt><big>(</big><em>name</em>, <em>schema</em>, <em>ProductName</em>, <em>ProductCode</em>, <em>ProductVersion</em>, <em>Manufacturer</em><big>)</big><a class="headerlink" href="#msilib.init_database" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>name</em> という名前の新しいデータベースを作り、 <em>schema</em> で初期化し、プロパティ <em>ProductName</em>, <em>ProductCode</em>,
<em>ProductVersion</em>, <em>Manufacturer</em> をセットして、返します</p>
<p><em>schema</em> は <tt class="docutils literal"><span class="pre">tables</span></tt> と <tt class="docutils literal"><span class="pre">_Validation_records</span></tt> という属性をもったモジュールオブジェクトでなければなりません。典型的には、 <a class="reference internal" href="#msilib.schema" title="msilib.schema"><tt class="xref py py-mod docutils literal"><span class="pre">msilib.schema</span></tt></a> を使うべきです。</p>
<p>データベースはこの関数から返された時点でスキーマとバリデーションレコードだけが収められています。</p>
</dd></dl>
<dl class="function">
<dt id="msilib.add_data"><a name="//apple_ref/cpp/Function/msilib.add_data"></a>
<tt class="descclassname">msilib.</tt><tt class="descname">add_data</tt><big>(</big><em>database</em>, <em>table</em>, <em>records</em><big>)</big><a class="headerlink" href="#msilib.add_data" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>全ての <em>records</em> を <em>database</em> の <em>table</em> テーブルに追加します。</p>
<p><em>table</em> 引数は MSI スキーマで事前に定義されたテーブルでなければなりません。例えば、 <tt class="docutils literal"><span class="pre">'Feature'</span></tt>, <tt class="docutils literal"><span class="pre">'File'</span></tt>, <tt class="docutils literal"><span class="pre">'Component'</span></tt>, <tt class="docutils literal"><span class="pre">'Dialog'</span></tt>, <tt class="docutils literal"><span class="pre">'Control'</span></tt>,
などです。</p>
<p><em>records</em> はタプルのリストで、それぞれのタプルにはテーブルのスキーマに従ったレコードの全てのフィールドを含んでいるものでなければなりません。オプションのフィールドには <tt class="docutils literal"><span class="pre">None</span></tt> を渡すことができます。</p>
<p>フィールドの値には、整数・長整数・文字列・Binary クラスのインスタンスが使えます。</p>
</dd></dl>
<dl class="class">
<dt id="msilib.Binary"><a name="//apple_ref/cpp/Class/msilib.Binary"></a>
<em class="property">class </em><tt class="descclassname">msilib.</tt><tt class="descname">Binary</tt><big>(</big><em>filename</em><big>)</big><a class="headerlink" href="#msilib.Binary" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Binary テーブル中のエントリーを表わします。 <a class="reference internal" href="#msilib.add_data" title="msilib.add_data"><tt class="xref py py-func docutils literal"><span class="pre">add_data()</span></tt></a> を使ってこのクラスのオブジェクトを挿入するときには <em>filename</em>
という名前のファイルをテーブルに読み込みます。</p>
</dd></dl>
<dl class="function">
<dt id="msilib.add_tables"><a name="//apple_ref/cpp/Function/msilib.add_tables"></a>
<tt class="descclassname">msilib.</tt><tt class="descname">add_tables</tt><big>(</big><em>database</em>, <em>module</em><big>)</big><a class="headerlink" href="#msilib.add_tables" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>module</em> の全てのテーブルの内容を <em>database</em> に追加します。 <em>module</em> は <em>tables</em>
という内容が追加されるべき全てのテーブルのリストと、テーブルごとに一つある実際の内容を持っている属性とを含んでいなければなりません。</p>
<p>この関数は典型的にシーケンステーブルをインストールするのに使われます。</p>
</dd></dl>
<dl class="function">
<dt id="msilib.add_stream"><a name="//apple_ref/cpp/Function/msilib.add_stream"></a>
<tt class="descclassname">msilib.</tt><tt class="descname">add_stream</tt><big>(</big><em>database</em>, <em>name</em>, <em>path</em><big>)</big><a class="headerlink" href="#msilib.add_stream" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>database</em> の <tt class="docutils literal"><span class="pre">_Stream</span></tt> テーブルに、ファイル <em>path</em> を <em>name</em> というストリーム名で追加します。</p>
</dd></dl>
<dl class="function">
<dt id="msilib.gen_uuid"><a name="//apple_ref/cpp/Function/msilib.gen_uuid"></a>
<tt class="descclassname">msilib.</tt><tt class="descname">gen_uuid</tt><big>(</big><big>)</big><a class="headerlink" href="#msilib.gen_uuid" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>新しい UUID を、 MSI が通常要求する形式(すなわち、中括弧に入れ、16進数は大文字)で返します。</p>
</dd></dl>
<div class="admonition- admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last"><a class="reference external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/devnotes/winprog/fcicreate.asp">FCICreateFile</a>
<a class="reference external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/rpc/rpc/uuidcreate.asp">UuidCreate</a>
<a class="reference external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/rpc/rpc/uuidtostring.asp">UuidToString</a></p>
</div>
<div class="section" id="database-objects">
<span id="id1"></span><h2>34.1.1. データベースオブジェクト<a class="headerlink" href="#database-objects" title="このヘッドラインへのパーマリンク">¶</a></h2>
<dl class="method">
<dt id="msilib.Database.OpenView"><a name="//apple_ref/cpp/Method/msilib.Database.OpenView"></a>
<tt class="descclassname">Database.</tt><tt class="descname">OpenView</tt><big>(</big><em>sql</em><big>)</big><a class="headerlink" href="#msilib.Database.OpenView" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><tt class="xref c c-func docutils literal"><span class="pre">MSIDatabaseOpenView()</span></tt> を呼び出してビューオブジェクトを返します。 <em>sql</em> は実行される SQL 命令です。</p>
</dd></dl>
<dl class="method">
<dt id="msilib.Database.Commit"><a name="//apple_ref/cpp/Method/msilib.Database.Commit"></a>
<tt class="descclassname">Database.</tt><tt class="descname">Commit</tt><big>(</big><big>)</big><a class="headerlink" href="#msilib.Database.Commit" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><tt class="xref c c-func docutils literal"><span class="pre">MSIDatabaseCommit()</span></tt> を呼び出して現在のトランザクションで保留されている変更をコミットします。</p>
</dd></dl>
<dl class="method">
<dt id="msilib.Database.GetSummaryInformation"><a name="//apple_ref/cpp/Method/msilib.Database.GetSummaryInformation"></a>
<tt class="descclassname">Database.</tt><tt class="descname">GetSummaryInformation</tt><big>(</big><em>count</em><big>)</big><a class="headerlink" href="#msilib.Database.GetSummaryInformation" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><tt class="xref c c-func docutils literal"><span class="pre">MsiGetSummaryInformation()</span></tt> を呼び出して新しいサマリー情報オブジェクトを返します。 <em>count</em>
は更新された値の最大数です。</p>
</dd></dl>
<div class="admonition- admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last"><a class="reference external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/msidatabaseopenview.asp">MSIDatabaseOpenView</a>
<a class="reference external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/msidatabasecommit.asp">MSIDatabaseCommit</a>
<a class="reference external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/msigetsummaryinformation.asp">MSIGetSummaryInformation</a></p>
</div>
</div>
<div class="section" id="view-objects">
<span id="id2"></span><h2>34.1.2. ビューオブジェクト<a class="headerlink" href="#view-objects" title="このヘッドラインへのパーマリンク">¶</a></h2>
<dl class="method">
<dt id="msilib.View.Execute"><a name="//apple_ref/cpp/Method/msilib.View.Execute"></a>
<tt class="descclassname">View.</tt><tt class="descname">Execute</tt><big>(</big><em>params</em><big>)</big><a class="headerlink" href="#msilib.View.Execute" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><tt class="xref c c-func docutils literal"><span class="pre">MSIViewExecute()</span></tt> を通してビューに対する SQL 問い合わせを実行します。
<em>params</em> が <tt class="docutils literal"><span class="pre">None</span></tt> でない場合、クエリ中のパラメータトークンの実際の値を与えるものです。</p>
</dd></dl>
<dl class="method">
<dt id="msilib.View.GetColumnInfo"><a name="//apple_ref/cpp/Method/msilib.View.GetColumnInfo"></a>
<tt class="descclassname">View.</tt><tt class="descname">GetColumnInfo</tt><big>(</big><em>kind</em><big>)</big><a class="headerlink" href="#msilib.View.GetColumnInfo" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><tt class="xref c c-func docutils literal"><span class="pre">MsiViewGetColumnInfo()</span></tt> の呼び出しを通してビューのカラムを説明するレコードを返します。 <em>kind</em> は
<tt class="docutils literal"><span class="pre">MSICOLINFO_NAMES</span></tt> または <tt class="docutils literal"><span class="pre">MSICOLINFO_TYPES</span></tt> です。</p>
</dd></dl>
<dl class="method">
<dt id="msilib.View.Fetch"><a name="//apple_ref/cpp/Method/msilib.View.Fetch"></a>
<tt class="descclassname">View.</tt><tt class="descname">Fetch</tt><big>(</big><big>)</big><a class="headerlink" href="#msilib.View.Fetch" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><tt class="xref c c-func docutils literal"><span class="pre">MsiViewFetch()</span></tt> の呼び出しを通してクエリの結果レコードを返します。</p>
</dd></dl>
<dl class="method">
<dt id="msilib.View.Modify"><a name="//apple_ref/cpp/Method/msilib.View.Modify"></a>
<tt class="descclassname">View.</tt><tt class="descname">Modify</tt><big>(</big><em>kind</em>, <em>data</em><big>)</big><a class="headerlink" href="#msilib.View.Modify" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><tt class="xref c c-func docutils literal"><span class="pre">MsiViewModify()</span></tt> を呼び出してビューを変更します。 <em>kind</em> は <tt class="docutils literal"><span class="pre">MSIMODIFY_SEEK</span></tt>,
<tt class="docutils literal"><span class="pre">MSIMODIFY_REFRESH</span></tt>, <tt class="docutils literal"><span class="pre">MSIMODIFY_INSERT</span></tt>, <tt class="docutils literal"><span class="pre">MSIMODIFY_UPDATE</span></tt>,
<tt class="docutils literal"><span class="pre">MSIMODIFY_ASSIGN</span></tt>, <tt class="docutils literal"><span class="pre">MSIMODIFY_REPLACE</span></tt>, <tt class="docutils literal"><span class="pre">MSIMODIFY_MERGE</span></tt>,
<tt class="docutils literal"><span class="pre">MSIMODIFY_DELETE</span></tt>, <tt class="docutils literal"><span class="pre">MSIMODIFY_INSERT_TEMPORARY</span></tt>, <tt class="docutils literal"><span class="pre">MSIMODIFY_VALIDATE</span></tt>,
<tt class="docutils literal"><span class="pre">MSIMODIFY_VALIDATE_NEW</span></tt>, <tt class="docutils literal"><span class="pre">MSIMODIFY_VALIDATE_FIELD</span></tt>,
<tt class="docutils literal"><span class="pre">MSIMODIFY_VALIDATE_DELETE</span></tt> のいずれかです。</p>
<p><em>data</em> は新しいデータを表わすレコードでなければなりません。</p>
</dd></dl>
<dl class="method">
<dt id="msilib.View.Close"><a name="//apple_ref/cpp/Method/msilib.View.Close"></a>
<tt class="descclassname">View.</tt><tt class="descname">Close</tt><big>(</big><big>)</big><a class="headerlink" href="#msilib.View.Close" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><tt class="xref c c-func docutils literal"><span class="pre">MsiViewClose()</span></tt> を通してビューを閉じます。</p>
</dd></dl>
<div class="admonition- admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last"><a class="reference external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/msiviewexecute.asp">MsiViewExecute</a>
<a class="reference external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/msiviewgetcolumninfo.asp">MSIViewGetColumnInfo</a>
<a class="reference external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/msiviewfetch.asp">MsiViewFetch</a>
<a class="reference external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/msiviewmodify.asp">MsiViewModify</a>
<a class="reference external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/msiviewclose.asp">MsiViewClose</a></p>
</div>
</div>
<div class="section" id="summary-objects">
<span id="id3"></span><h2>34.1.3. サマリー情報オブジェクト<a class="headerlink" href="#summary-objects" title="このヘッドラインへのパーマリンク">¶</a></h2>
<dl class="method">
<dt id="msilib.SummaryInformation.GetProperty"><a name="//apple_ref/cpp/Method/msilib.SummaryInformation.GetProperty"></a>
<tt class="descclassname">SummaryInformation.</tt><tt class="descname">GetProperty</tt><big>(</big><em>field</em><big>)</big><a class="headerlink" href="#msilib.SummaryInformation.GetProperty" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><tt class="xref c c-func docutils literal"><span class="pre">MsiSummaryInfoGetProperty()</span></tt> を通してサマリーのプロパティを返します。 <em>field</em> はプロパティ名で、定数
<tt class="docutils literal"><span class="pre">PID_CODEPAGE</span></tt>, <tt class="docutils literal"><span class="pre">PID_TITLE</span></tt>, <tt class="docutils literal"><span class="pre">PID_SUBJECT</span></tt>, <tt class="docutils literal"><span class="pre">PID_AUTHOR</span></tt>,
<tt class="docutils literal"><span class="pre">PID_KEYWORDS</span></tt>, <tt class="docutils literal"><span class="pre">PID_COMMENTS</span></tt>, <tt class="docutils literal"><span class="pre">PID_TEMPLATE</span></tt>, <tt class="docutils literal"><span class="pre">PID_LASTAUTHOR</span></tt>,
<tt class="docutils literal"><span class="pre">PID_REVNUMBER</span></tt>, <tt class="docutils literal"><span class="pre">PID_LASTPRINTED</span></tt>, <tt class="docutils literal"><span class="pre">PID_CREATE_DTM</span></tt>,
<tt class="docutils literal"><span class="pre">PID_LASTSAVE_DTM</span></tt>, <tt class="docutils literal"><span class="pre">PID_PAGECOUNT</span></tt>, <tt class="docutils literal"><span class="pre">PID_WORDCOUNT</span></tt>, <tt class="docutils literal"><span class="pre">PID_CHARCOUNT</span></tt>,
<tt class="docutils literal"><span class="pre">PID_APPNAME</span></tt>, <tt class="docutils literal"><span class="pre">PID_SECURITY</span></tt> のいずれかです。</p>
</dd></dl>
<dl class="method">
<dt id="msilib.SummaryInformation.GetPropertyCount"><a name="//apple_ref/cpp/Method/msilib.SummaryInformation.GetPropertyCount"></a>
<tt class="descclassname">SummaryInformation.</tt><tt class="descname">GetPropertyCount</tt><big>(</big><big>)</big><a class="headerlink" href="#msilib.SummaryInformation.GetPropertyCount" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><tt class="xref c c-func docutils literal"><span class="pre">MsiSummaryInfoGetPropertyCount()</span></tt> を通してサマリープロパティの個数を返します。</p>
</dd></dl>
<dl class="method">
<dt id="msilib.SummaryInformation.SetProperty"><a name="//apple_ref/cpp/Method/msilib.SummaryInformation.SetProperty"></a>
<tt class="descclassname">SummaryInformation.</tt><tt class="descname">SetProperty</tt><big>(</big><em>field</em>, <em>value</em><big>)</big><a class="headerlink" href="#msilib.SummaryInformation.SetProperty" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><tt class="xref c c-func docutils literal"><span class="pre">MsiSummaryInfoSetProperty()</span></tt> を通してプロパティをセットします。 <em>field</em> は
<a class="reference internal" href="#msilib.SummaryInformation.GetProperty" title="msilib.SummaryInformation.GetProperty"><tt class="xref py py-meth docutils literal"><span class="pre">GetProperty()</span></tt></a> におけるものと同じ値をとります。 <em>value</em> はプロパティの新しい値です。許される値の型は整数と文字列です。</p>
</dd></dl>
<dl class="method">
<dt id="msilib.SummaryInformation.Persist"><a name="//apple_ref/cpp/Method/msilib.SummaryInformation.Persist"></a>
<tt class="descclassname">SummaryInformation.</tt><tt class="descname">Persist</tt><big>(</big><big>)</big><a class="headerlink" href="#msilib.SummaryInformation.Persist" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><tt class="xref c c-func docutils literal"><span class="pre">MsiSummaryInfoPersist()</span></tt> を使って変更されたプロパティをサマリー情報ストリームに書き込みます。</p>
</dd></dl>
<div class="admonition- admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last"><a class="reference external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/msisummaryinfogetproperty.asp">MsiSummaryInfoGetProperty</a>
<a class="reference external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/msisummaryinfogetpropertycount.asp">MsiSummaryInfoGetPropertyCount</a>
<a class="reference external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/msisummaryinfosetproperty.asp">MsiSummaryInfoSetProperty</a>
<a class="reference external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/msisummaryinfopersist.asp">MsiSummaryInfoPersist</a></p>
</div>
</div>
<div class="section" id="record-objects">
<span id="id4"></span><h2>34.1.4. レコードオブジェクト<a class="headerlink" href="#record-objects" title="このヘッドラインへのパーマリンク">¶</a></h2>
<dl class="method">
<dt id="msilib.Record.GetFieldCount"><a name="//apple_ref/cpp/Method/msilib.Record.GetFieldCount"></a>
<tt class="descclassname">Record.</tt><tt class="descname">GetFieldCount</tt><big>(</big><big>)</big><a class="headerlink" href="#msilib.Record.GetFieldCount" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><tt class="xref c c-func docutils literal"><span class="pre">MsiRecordGetFieldCount()</span></tt> を通してレコードのフィールド数を返します。</p>
</dd></dl>
<dl class="method">
<dt id="msilib.Record.GetInteger"><a name="//apple_ref/cpp/Method/msilib.Record.GetInteger"></a>
<tt class="descclassname">Record.</tt><tt class="descname">GetInteger</tt><big>(</big><em>field</em><big>)</big><a class="headerlink" href="#msilib.Record.GetInteger" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>field</em> の値を可能なら整数として返します。 <em>field</em> は整数でなければなりません。</p>
</dd></dl>
<dl class="method">
<dt id="msilib.Record.GetString"><a name="//apple_ref/cpp/Method/msilib.Record.GetString"></a>
<tt class="descclassname">Record.</tt><tt class="descname">GetString</tt><big>(</big><em>field</em><big>)</big><a class="headerlink" href="#msilib.Record.GetString" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>field</em> の値を可能なら文字列として返します。 <em>field</em> は整数でなければなりません。</p>
</dd></dl>
<dl class="method">
<dt id="msilib.Record.SetString"><a name="//apple_ref/cpp/Method/msilib.Record.SetString"></a>
<tt class="descclassname">Record.</tt><tt class="descname">SetString</tt><big>(</big><em>field</em>, <em>value</em><big>)</big><a class="headerlink" href="#msilib.Record.SetString" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><tt class="xref c c-func docutils literal"><span class="pre">MsiRecordSetString()</span></tt> を通して <em>field</em> を <em>value</em> にセットします。 <em>field</em> は整数、 <em>value</em>
は文字列でなければなりません。</p>
</dd></dl>
<dl class="method">
<dt id="msilib.Record.SetStream"><a name="//apple_ref/cpp/Method/msilib.Record.SetStream"></a>
<tt class="descclassname">Record.</tt><tt class="descname">SetStream</tt><big>(</big><em>field</em>, <em>value</em><big>)</big><a class="headerlink" href="#msilib.Record.SetStream" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><tt class="xref c c-func docutils literal"><span class="pre">MsiRecordSetStream()</span></tt> を通して <em>field</em> を <em>value</em> という名のファイルの内容にセットします。 <em>field</em>
は整数、 <em>value</em> は文字列でなければなりません。</p>
</dd></dl>
<dl class="method">
<dt id="msilib.Record.SetInteger"><a name="//apple_ref/cpp/Method/msilib.Record.SetInteger"></a>
<tt class="descclassname">Record.</tt><tt class="descname">SetInteger</tt><big>(</big><em>field</em>, <em>value</em><big>)</big><a class="headerlink" href="#msilib.Record.SetInteger" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><tt class="xref c c-func docutils literal"><span class="pre">MsiRecordSetInteger()</span></tt> を通して <em>field</em> を <em>value</em> にセットします。 <em>field</em> も <em>value</em>
も整数でなければなりません。</p>
</dd></dl>
<dl class="method">
<dt id="msilib.Record.ClearData"><a name="//apple_ref/cpp/Method/msilib.Record.ClearData"></a>
<tt class="descclassname">Record.</tt><tt class="descname">ClearData</tt><big>(</big><big>)</big><a class="headerlink" href="#msilib.Record.ClearData" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><tt class="xref c c-func docutils literal"><span class="pre">MsiRecordClearData()</span></tt> を通してレコードの全てのフィールドを 0 にセットします。</p>
</dd></dl>
<div class="admonition- admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last"><a class="reference external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/msirecordgetfieldcount.asp">MsiRecordGetFieldCount</a>
<a class="reference external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/msirecordsetstring.asp">MsiRecordSetString</a>
<a class="reference external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/msirecordsetstream.asp">MsiRecordSetStream</a>
<a class="reference external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/msirecordsetinteger.asp">MsiRecordSetInteger</a>
<a class="reference external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/msirecordclear.asp">MsiRecordClear</a></p>
</div>
</div>
<div class="section" id="msi-errors">
<span id="id5"></span><h2>34.1.5. エラー<a class="headerlink" href="#msi-errors" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>全ての MSI 関数のラッパーは <tt class="xref py py-exc docutils literal"><span class="pre">MsiError</span></tt> を送出します。例外の内部の文字列がより詳細な情報を含んでいます。</p>
</div>
<div class="section" id="cab">
<span id="id6"></span><h2>34.1.6. CAB オブジェクト<a class="headerlink" href="#cab" title="このヘッドラインへのパーマリンク">¶</a></h2>
<dl class="class">
<dt id="msilib.CAB"><a name="//apple_ref/cpp/Class/msilib.CAB"></a>
<em class="property">class </em><tt class="descclassname">msilib.</tt><tt class="descname">CAB</tt><big>(</big><em>name</em><big>)</big><a class="headerlink" href="#msilib.CAB" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><a class="reference internal" href="#msilib.CAB" title="msilib.CAB"><tt class="xref py py-class docutils literal"><span class="pre">CAB</span></tt></a> クラスは CAB ファイルを表わすものです。MSI 構築中、ファイルは <tt class="docutils literal"><span class="pre">Files</span></tt> テーブルと CAB
ファイルとに同時に追加されます。そして、全てのファイルを追加し終えたら、CAB ファイルは書き込まれることが可能になり、MSI ファイルに追加されます。</p>
<p><em>name</em> は MSI ファイル中の CAB ファイルの名前です。</p>
<dl class="method">
<dt id="msilib.CAB.append"><a name="//apple_ref/cpp/Method/msilib.CAB.append"></a>
<tt class="descname">append</tt><big>(</big><em>full</em>, <em>logical</em><big>)</big><a class="headerlink" href="#msilib.CAB.append" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>パス名 <em>full</em> のファイルを CAB ファイルに <em>logical</em> という名で追加します。 <em>logical</em>
という名が既に存在したならば、新しいファイル名が作られます。</p>
<p>ファイルの CAB ファイル中のインデクスと新しいファイル名を返します。</p>
</dd></dl>
<dl class="method">
<dt id="msilib.CAB.commit"><a name="//apple_ref/cpp/Method/msilib.CAB.commit"></a>
<tt class="descname">commit</tt><big>(</big><em>database</em><big>)</big><a class="headerlink" href="#msilib.CAB.commit" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>CAB ファイルを作り、MSI ファイルにストリームとして追加し、 <tt class="docutils literal"><span class="pre">Media</span></tt> テーブルに送り込み、作ったファイルはディスクから削除します。</p>
</dd></dl>
</dd></dl>
</div>
<div class="section" id="msi-directory">
<span id="id7"></span><h2>34.1.7. ディレクトリオブジェクト<a class="headerlink" href="#msi-directory" title="このヘッドラインへのパーマリンク">¶</a></h2>
<dl class="class">
<dt id="msilib.Directory"><a name="//apple_ref/cpp/Class/msilib.Directory"></a>
<em class="property">class </em><tt class="descclassname">msilib.</tt><tt class="descname">Directory</tt><big>(</big><em>database</em>, <em>cab</em>, <em>basedir</em>, <em>physical</em>, <em>logical</em>, <em>default</em><span class="optional">[</span>, <em>componentflags</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#msilib.Directory" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>新しいディレクトリを Directory テーブルに作成します。ディレクトリには各時点で現在のコンポーネントがあり、それは
<a class="reference internal" href="#msilib.Directory.start_component" title="msilib.Directory.start_component"><tt class="xref py py-meth docutils literal"><span class="pre">start_component()</span></tt></a> を使って明ら様に作成されたかまたは最初にファイルが追加された際に暗黙裡に作成されたものです。ファイルは現在のコンポーネントと cab ファイルに追加されます。ディレクトリを作成するには親ディレクトリオブジェクト(<tt class="docutils literal"><span class="pre">None</span></tt> でも可)、物理的ディレクトリへのパス、論理的ディレクトリ名を指定する必要があります。 <em>default</em> はディレクトリテーブルの DefaultDir
スロットを指定します。 <em>componentflags</em> は新しいコンポーネントが得るデフォルトのフラグを指定します。</p>
<dl class="method">
<dt id="msilib.Directory.start_component"><a name="//apple_ref/cpp/Method/msilib.Directory.start_component"></a>
<tt class="descname">start_component</tt><big>(</big><span class="optional">[</span><em>component</em><span class="optional">[</span>, <em>feature</em><span class="optional">[</span>, <em>flags</em><span class="optional">[</span>, <em>keyfile</em><span class="optional">[</span>, <em>uuid</em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><big>)</big><a class="headerlink" href="#msilib.Directory.start_component" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>エントリを Component テーブルに追加し、このコンポーネントをこのディレクトリの現在のコンポーネントにします。もしコンポーネント名が与えられなければディレクトリ名が使われます。 <em>feature</em>
が与えられなければ、ディレクトリのデフォルトフラグが使われます。 <em>keyfile</em> が与えられなければ、Component テーブルの KeyPath は
null のままになります。</p>
</dd></dl>
<dl class="method">
<dt id="msilib.Directory.add_file"><a name="//apple_ref/cpp/Method/msilib.Directory.add_file"></a>
<tt class="descname">add_file</tt><big>(</big><em>file</em><span class="optional">[</span>, <em>src</em><span class="optional">[</span>, <em>version</em><span class="optional">[</span>, <em>language</em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><big>)</big><a class="headerlink" href="#msilib.Directory.add_file" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ファイルをディレクトリの現在のコンポーネントに追加します。このとき現在のコンポーネントがなければ新しいものを開始します。デフォルトではソースとファイルテーブルのファイル名は同じになります。 <em>src</em>
ファイルが与えられたならば、それば現在のディレクトリから相対的に解釈されます。オプションで <em>version</em> と <em>language</em> を File
テーブルのエントリ用に指定することができます。</p>
</dd></dl>
<dl class="method">
<dt id="msilib.Directory.glob"><a name="//apple_ref/cpp/Method/msilib.Directory.glob"></a>
<tt class="descname">glob</tt><big>(</big><em>pattern</em><span class="optional">[</span>, <em>exclude</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#msilib.Directory.glob" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>現在のコンポーネントに glob パターンで指定されたファイルのリストを追加します。個々のファイルを <em>exclude</em> リストで除外することができます。</p>
</dd></dl>
<dl class="method">
<dt id="msilib.Directory.remove_pyc"><a name="//apple_ref/cpp/Method/msilib.Directory.remove_pyc"></a>
<tt class="descname">remove_pyc</tt><big>(</big><big>)</big><a class="headerlink" href="#msilib.Directory.remove_pyc" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>アンインストールの際に <tt class="docutils literal"><span class="pre">.pyc</span></tt> / <tt class="docutils literal"><span class="pre">.pyo</span></tt> を削除します。</p>
</dd></dl>
</dd></dl>
<div class="admonition- admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last"><a class="reference external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/directory_table.asp">Directory Table</a>
<a class="reference external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/file_table.asp">File Table</a>
<a class="reference external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/component_table.asp">Component Table</a>
<a class="reference external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/featurecomponents_table.asp">FeatureComponents Table</a></p>
</div>
</div>
<div class="section" id="features">
<span id="id8"></span><h2>34.1.8. フィーチャー<a class="headerlink" href="#features" title="このヘッドラインへのパーマリンク">¶</a></h2>
<dl class="class">
<dt id="msilib.Feature"><a name="//apple_ref/cpp/Class/msilib.Feature"></a>
<em class="property">class </em><tt class="descclassname">msilib.</tt><tt class="descname">Feature</tt><big>(</big><em>database</em>, <em>id</em>, <em>title</em>, <em>desc</em>, <em>display</em><span class="optional">[</span>, <em>level=1</em><span class="optional">[</span>, <em>parent</em><span class="optional">[</span>, <em>directory</em><span class="optional">[</span>, <em>attributes=0</em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><big>)</big><a class="headerlink" href="#msilib.Feature" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>id</em>, <em>parent.id</em>, <em>title</em>, <em>desc</em>, <em>display</em>, <em>level</em>, <em>directory</em>,
<em>attributes</em> の値を使って、新しいレコードを <tt class="docutils literal"><span class="pre">Feature</span></tt> テーブルに追加します。出来上がったフィーチャーオブジェクトは
<a class="reference internal" href="#msilib.Directory" title="msilib.Directory"><tt class="xref py py-class docutils literal"><span class="pre">Directory</span></tt></a> の <tt class="xref py py-meth docutils literal"><span class="pre">start_component()</span></tt> メソッドに渡すことができます。</p>
<dl class="method">
<dt id="msilib.Feature.set_current"><a name="//apple_ref/cpp/Method/msilib.Feature.set_current"></a>
<tt class="descname">set_current</tt><big>(</big><big>)</big><a class="headerlink" href="#msilib.Feature.set_current" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>このフィーチャーを <a class="reference internal" href="#module-msilib" title="msilib: Creation of Microsoft Installer files, and CAB files. (Windows)"><tt class="xref py py-mod docutils literal"><span class="pre">msilib</span></tt></a> の現在のフィーチャーにします。フィーチャーが明ら様に指定されない限り、新しいコンポーネントが自動的にデフォルトのフィーチャーに追加されます。</p>
</dd></dl>
</dd></dl>
<div class="admonition- admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last"><a class="reference external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/feature_table.asp">Feature Table</a></p>
</div>
</div>
<div class="section" id="gui">
<span id="msi-gui"></span><h2>34.1.9. GUI クラス<a class="headerlink" href="#gui" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p><a class="reference internal" href="#module-msilib" title="msilib: Creation of Microsoft Installer files, and CAB files. (Windows)"><tt class="xref py py-mod docutils literal"><span class="pre">msilib</span></tt></a> モジュールは MSI データベースの中の GUI テーブルをラップする幾つかのクラスを提供しています。しかしながら、標準で提供されるユーザーインタフェースはありません。インストールする Python
パッケージに対するユーザーインタフェース付きの MSI ファイルを作成するには <tt class="xref py py-mod docutils literal"><span class="pre">bdist_msi</span></tt> を使ってください。</p>
<dl class="class">
<dt id="msilib.Control"><a name="//apple_ref/cpp/Class/msilib.Control"></a>
<em class="property">class </em><tt class="descclassname">msilib.</tt><tt class="descname">Control</tt><big>(</big><em>dlg</em>, <em>name</em><big>)</big><a class="headerlink" href="#msilib.Control" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ダイアログコントロールの基底クラス。 <em>dlg</em> はコントロールの属するダイアログオブジェクト、 <em>name</em> はコントロールの名前です。</p>
<dl class="method">
<dt id="msilib.Control.event"><a name="//apple_ref/cpp/Method/msilib.Control.event"></a>
<tt class="descname">event</tt><big>(</big><em>event</em>, <em>argument</em><span class="optional">[</span>, <em>condition=1</em><span class="optional">[</span>, <em>ordering</em><span class="optional">]</span><span class="optional">]</span><big>)</big><a class="headerlink" href="#msilib.Control.event" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>このコントロールの <tt class="docutils literal"><span class="pre">ControlEvent</span></tt> テーブルにエントリを作ります。</p>
</dd></dl>
<dl class="method">
<dt id="msilib.Control.mapping"><a name="//apple_ref/cpp/Method/msilib.Control.mapping"></a>
<tt class="descname">mapping</tt><big>(</big><em>event</em>, <em>attribute</em><big>)</big><a class="headerlink" href="#msilib.Control.mapping" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>このコントロールの <tt class="docutils literal"><span class="pre">EventMapping</span></tt> テーブルにエントリを作ります。</p>
</dd></dl>
<dl class="method">
<dt id="msilib.Control.condition"><a name="//apple_ref/cpp/Method/msilib.Control.condition"></a>
<tt class="descname">condition</tt><big>(</big><em>action</em>, <em>condition</em><big>)</big><a class="headerlink" href="#msilib.Control.condition" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>このコントロールの <tt class="docutils literal"><span class="pre">ControlCondition</span></tt> テーブルにエントリを作ります。</p>
</dd></dl>
</dd></dl>
<dl class="class">
<dt id="msilib.RadioButtonGroup"><a name="//apple_ref/cpp/Class/msilib.RadioButtonGroup"></a>
<em class="property">class </em><tt class="descclassname">msilib.</tt><tt class="descname">RadioButtonGroup</tt><big>(</big><em>dlg</em>, <em>name</em>, <em>property</em><big>)</big><a class="headerlink" href="#msilib.RadioButtonGroup" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>name</em> という名前のラジオボタンコントロールを作成します。 <em>property</em> はラジオボタンが選ばれたときにセットされるインストーラープロパティです。</p>
<dl class="method">
<dt id="msilib.RadioButtonGroup.add"><a name="//apple_ref/cpp/Method/msilib.RadioButtonGroup.add"></a>
<tt class="descname">add</tt><big>(</big><em>name</em>, <em>x</em>, <em>y</em>, <em>width</em>, <em>height</em>, <em>text</em><span class="optional">[</span>, <em>value</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#msilib.RadioButtonGroup.add" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>グループに <em>name</em> という名前で、座標 <em>x</em>, <em>y</em> に大きさが <em>width</em>, <em>height</em> で <em>text</em> というラベルの付いたラジオボタンを追加します。 <em>value</em> が省略された場合、デフォルトは <em>name</em> になります。</p>
</dd></dl>
</dd></dl>
<dl class="class">
<dt id="msilib.Dialog"><a name="//apple_ref/cpp/Class/msilib.Dialog"></a>
<em class="property">class </em><tt class="descclassname">msilib.</tt><tt class="descname">Dialog</tt><big>(</big><em>db</em>, <em>name</em>, <em>x</em>, <em>y</em>, <em>w</em>, <em>h</em>, <em>attr</em>, <em>title</em>, <em>first</em>, <em>default</em>, <em>cancel</em><big>)</big><a class="headerlink" href="#msilib.Dialog" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>新しい <a class="reference internal" href="#msilib.Dialog" title="msilib.Dialog"><tt class="xref py py-class docutils literal"><span class="pre">Dialog</span></tt></a> オブジェクトを返します。 <tt class="docutils literal"><span class="pre">Dialog</span></tt> テーブルの中に指定された座標、ダイアログ属性、タイトル、最初とデフォルトとキャンセルコントロールの名前を持ったエントリが作られます。</p>
<dl class="method">
<dt id="msilib.Dialog.control"><a name="//apple_ref/cpp/Method/msilib.Dialog.control"></a>
<tt class="descname">control</tt><big>(</big><em>name</em>, <em>type</em>, <em>x</em>, <em>y</em>, <em>width</em>, <em>height</em>, <em>attributes</em>, <em>property</em>, <em>text</em>, <em>control_next</em>, <em>help</em><big>)</big><a class="headerlink" href="#msilib.Dialog.control" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>新しい <a class="reference internal" href="#msilib.Control" title="msilib.Control"><tt class="xref py py-class docutils literal"><span class="pre">Control</span></tt></a> オブジェクトを返します。 <tt class="docutils literal"><span class="pre">Control</span></tt> テーブルに指定されたパラメータのエントリが作られます。</p>
<p>これは汎用のメソッドで、特定の型に対しては特化したメソッドが提供されています。</p>
</dd></dl>
<dl class="method">
<dt id="msilib.Dialog.text"><a name="//apple_ref/cpp/Method/msilib.Dialog.text"></a>
<tt class="descname">text</tt><big>(</big><em>name</em>, <em>x</em>, <em>y</em>, <em>width</em>, <em>height</em>, <em>attributes</em>, <em>text</em><big>)</big><a class="headerlink" href="#msilib.Dialog.text" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><tt class="docutils literal"><span class="pre">Text</span></tt> コントロールを追加して返します。</p>
</dd></dl>
<dl class="method">
<dt id="msilib.Dialog.bitmap"><a name="//apple_ref/cpp/Method/msilib.Dialog.bitmap"></a>
<tt class="descname">bitmap</tt><big>(</big><em>name</em>, <em>x</em>, <em>y</em>, <em>width</em>, <em>height</em>, <em>text</em><big>)</big><a class="headerlink" href="#msilib.Dialog.bitmap" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><tt class="docutils literal"><span class="pre">Bitmap</span></tt> コントロールを追加して返します。</p>
</dd></dl>
<dl class="method">
<dt id="msilib.Dialog.line"><a name="//apple_ref/cpp/Method/msilib.Dialog.line"></a>
<tt class="descname">line</tt><big>(</big><em>name</em>, <em>x</em>, <em>y</em>, <em>width</em>, <em>height</em><big>)</big><a class="headerlink" href="#msilib.Dialog.line" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><tt class="docutils literal"><span class="pre">Line</span></tt> コントロールを追加して返します。</p>
</dd></dl>
<dl class="method">
<dt id="msilib.Dialog.pushbutton"><a name="//apple_ref/cpp/Method/msilib.Dialog.pushbutton"></a>
<tt class="descname">pushbutton</tt><big>(</big><em>name</em>, <em>x</em>, <em>y</em>, <em>width</em>, <em>height</em>, <em>attributes</em>, <em>text</em>, <em>next_control</em><big>)</big><a class="headerlink" href="#msilib.Dialog.pushbutton" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><tt class="docutils literal"><span class="pre">PushButton</span></tt> コントロールを追加して返します。</p>
</dd></dl>
<dl class="method">
<dt id="msilib.Dialog.radiogroup"><a name="//apple_ref/cpp/Method/msilib.Dialog.radiogroup"></a>
<tt class="descname">radiogroup</tt><big>(</big><em>name</em>, <em>x</em>, <em>y</em>, <em>width</em>, <em>height</em>, <em>attributes</em>, <em>property</em>, <em>text</em>, <em>next_control</em><big>)</big><a class="headerlink" href="#msilib.Dialog.radiogroup" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><tt class="docutils literal"><span class="pre">RadioButtonGroup</span></tt> コントロールを追加して返します。</p>
</dd></dl>
<dl class="method">
<dt id="msilib.Dialog.checkbox"><a name="//apple_ref/cpp/Method/msilib.Dialog.checkbox"></a>
<tt class="descname">checkbox</tt><big>(</big><em>name</em>, <em>x</em>, <em>y</em>, <em>width</em>, <em>height</em>, <em>attributes</em>, <em>property</em>, <em>text</em>, <em>next_control</em><big>)</big><a class="headerlink" href="#msilib.Dialog.checkbox" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><tt class="docutils literal"><span class="pre">CheckBox</span></tt> コントロールを追加して返します。</p>
</dd></dl>
</dd></dl>
<div class="admonition- admonition seealso">
<p class="first admonition-title">参考</p>
<p class="last"><a class="reference external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/dialog_table.asp">Dialog Table</a>
<a class="reference external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/control_table.asp">Control Table</a>
<a class="reference external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/controls.asp">Control Types</a>
<a class="reference external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/controlcondition_table.asp">ControlCondition Table</a>
<a class="reference external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/controlevent_table.asp">ControlEvent Table</a>
<a class="reference external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/eventmapping_table.asp">EventMapping Table</a>
<a class="reference external" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/msi/setup/radiobutton_table.asp">RadioButton Table</a></p>
</div>
</div>
<div class="section" id="msi-tables">
<span id="id9"></span><h2>34.1.10. 事前に計算されたテーブル<a class="headerlink" href="#msi-tables" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p><a class="reference internal" href="#module-msilib" title="msilib: Creation of Microsoft Installer files, and CAB files. (Windows)"><tt class="xref py py-mod docutils literal"><span class="pre">msilib</span></tt></a> はスキーマとテーブル定義だけから成るサブパッケージをいくつか提供しています。現在のところ、これらの定義は MSI バージョン
2.0 に基づいています。</p>
<dl class="data">
<dt id="msilib.schema"><a name="//apple_ref/cpp/Value/msilib.schema"></a>
<tt class="descclassname">msilib.</tt><tt class="descname">schema</tt><a class="headerlink" href="#msilib.schema" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>これは MSI 2.0 用の標準 MSI スキーマで、テーブル定義のリストを提供する <em>tables</em> 変数と、MSI バリデーション用のデータを提供する
<em>_Validation_records</em> 変数があります。</p>
</dd></dl>
<dl class="data">
<dt id="msilib.sequence"><a name="//apple_ref/cpp/Value/msilib.sequence"></a>
<tt class="descclassname">msilib.</tt><tt class="descname">sequence</tt><a class="headerlink" href="#msilib.sequence" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>このモジュールは標準シーケンステーブルのテーブル内容を含んでいます。 <em>AdminExecuteSequence</em>, <em>AdminUISequence</em>,
<em>AdvtExecuteSequence</em>, <em>InstallExecuteSequence</em>, <em>InstallUISequence</em> が含まれています。</p>
</dd></dl>
<dl class="data">
<dt id="msilib.text"><a name="//apple_ref/cpp/Value/msilib.text"></a>
<tt class="descclassname">msilib.</tt><tt class="descname">text</tt><a class="headerlink" href="#msilib.text" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>このモジュールは標準的なインストーラーのアクションのための UIText および ActionText テーブルの定義を含んでいます。</p>
</dd></dl>
</div>
</div>
</div>
</div>
</div>
<div class="clearer"></div>
</div>
<div class="related">
<h3>ナビゲーション</h3>
<ul>
<li class="right" style="margin-right: 10px">
<a href="../genindex.html" title="総合索引">索引</a></li>
<li class="right">
<a href="../py-modindex.html" title="Pythonモジュール索引">モジュール</a> |</li>
<li class="right">
<a href="msvcrt.html" title="34.2. msvcrt – MS VC++実行時システムの有用なルーチン群">次へ</a> |</li>
<li class="right">
<a href="windows.html" title="34. MS Windows 固有のサービス">前へ</a> |</li>
<li><img alt="" src="../_static/py.png" style="vertical-align: middle; margin-top: -1px"/></li>
<li><a href="../index.html">Python 2.7ja1 documentation</a> »</li>
<li><a href="index.html">Python 標準ライブラリ</a> »</li>
<li><a href="windows.html">34. MS Windows 固有のサービス</a> »</li>
</ul>
</div>
<div class="footer">
        © <a href="../copyright.html">Copyright</a> 1990-2011, Python Software Foundation.
      最終更新: 2011-12-26
      このドキュメントは <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2pre/02cb752c6a9e で生成しました。
    </div>
</body>
</html>